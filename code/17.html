<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prefix Sum Array Construction</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background: white;
            color: black;
            height: 100vh;
            display: flex;
        }
        
        .container {
            display: flex;
            width: 100%;
            height: 100vh;
        }
        
        .left-panel {
            width: 60%;
            padding: 20px;
            border-right: 2px solid black;
            overflow-y: auto;
        }
        
        .right-panel {
            width: 40%;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .question-section {
            margin-bottom: 15px;
            padding: 15px;
            border: 2px solid black;
        }
        
        .navigation {
            margin-bottom: 15px;
            text-align: center;
        }
        
        .nav-btn {
            background: white;
            color: black;
            border: 2px solid black;
            padding: 10px 20px;
            margin: 0 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        
        .nav-btn:hover {
            background: black;
            color: white;
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .section {
            margin-bottom: 15px;
            padding: 15px;
            border: 2px solid black;
        }
        
        .section-title {
            font-weight: bold;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid black;
        }
        
        .variables-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .variable {
            padding: 8px;
            border: 1px solid black;
            background: white;
        }
        
        .variable.active {
            background: yellow;
        }
        
        .variable.increment {
            background: #90EE90;
        }
        
        .variable.decrement {
            background: #FFB6C1;
        }
        
        .condition {
            padding: 8px;
            margin: 5px 0;
            border: 1px solid black;
        }
        
        .condition.true {
            background: #90EE90;
        }
        
        .condition.false {
            background: #FFB6C1;
        }
        
        .operation {
            padding: 8px;
            margin: 5px 0;
            border: 1px solid black;
        }
        
        .operation.increment {
            background: #90EE90;
        }
        
        .operation.add {
            background: #ADD8E6;
        }
        
        .array-display {
            position: relative;
            margin: 20px 0;
        }
        
        .array-container {
            display: flex;
            gap: 2px;
            margin-bottom: 10px;
        }
        
        .array-cell {
            width: 80px;
            height: 80px;
            border: 3px solid black;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            position: relative;
            background: white;
        }
        
        .array-cell.current {
            border-color: #FF1493;
            background: #FFE4E1;
        }
        
        .array-cell.processed {
            background: #F0F0F0;
        }
        
        .pointer {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }
        
        .pointer.current {
            background: #FF1493;
        }
        
        .array-label {
            font-weight: bold;
            margin-bottom: 5px;
            text-align: left;
        }
        
        .step-counter {
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
        }
        
        .collapsible {
            margin-top: 20px;
        }
        
        .collapsible-header {
            background: white;
            border: 2px solid black;
            padding: 10px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .collapsible-header:hover {
            background: black;
            color: white;
        }
        
        .collapsible-content {
            display: none;
            padding: 15px;
            border: 2px solid black;
            border-top: none;
        }
        
        .collapsible-content.show {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="left-panel">
            <div class="question-section">
                <h3>Problem: Prefix Sum Array Construction</h3>
                <p><strong>Input:</strong> Array [1, 2, 3, 4]</p>
                <p><strong>Output:</strong> Array [1, 3, 6, 10]</p>
                <p><strong>Goal:</strong> Build prefix sum where each element is sum of all previous elements including itself</p>
            </div>
            
            <div class="navigation">
                <button class="nav-btn" id="prevBtn">Previous</button>
                <button class="nav-btn" id="nextBtn">Next</button>
                <button class="nav-btn" id="resetBtn">Reset</button>
            </div>
            
            <div class="section">
                <div class="section-title">Variables</div>
                <div class="variables-grid">
                    <div class="variable" id="var-i">i: <span id="val-i">0</span></div>
                    <div class="variable" id="var-sum">sum: <span id="val-sum">0</span></div>
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">Current Condition</div>
                <div id="current-condition">Ready to start</div>
            </div>
            
            <div class="section">
                <div class="section-title">Current Operation</div>
                <div id="current-operation">Click Next to begin</div>
            </div>
            
            <div class="section">
                <div class="section-title">Result Array</div>
                <div id="result-display">[_, _, _, _]</div>
            </div>
            
            <div class="collapsible">
                <div class="collapsible-header" onclick="toggleCollapsible('theory')">
                    ▶ Algorithm Theory & Explanation
                </div>
                <div class="collapsible-content" id="theory">
                    <h4>What is Prefix Sum?</h4>
                    <p>A prefix sum array where each element contains the sum of all elements from the start of the original array up to and including the current position.</p>
                    
                    <h4>Algorithm Steps:</h4>
                    <ol>
                        <li>Initialize sum = 0</li>
                        <li>For each element in the input array:</li>
                        <li>Add current element to sum</li>
                        <li>Store sum in result array at current position</li>
                    </ol>
                    
                    <h4>Time Complexity:</h4>
                    <p>O(n) - single pass through the array</p>
                    
                    <h4>Space Complexity:</h4>
                    <p>O(n) - for the result array</p>
                </div>
            </div>
            
            <div class="collapsible">
                <div class="collapsible-header" onclick="toggleCollapsible('tricks')">
                    ▶ Tricks & Optimizations
                </div>
                <div class="collapsible-content" id="tricks">
                    <h4>In-place Calculation:</h4>
                    <p>If modifying the original array is allowed, you can calculate prefix sum in-place without extra space.</p>
                    
                    <h4>Range Sum Queries:</h4>
                    <p>Once prefix sum is built, range sum from index i to j can be calculated as: prefixSum[j] - prefixSum[i-1]</p>
                    
                    <h4>Overflow Considerations:</h4>
                    <p>For large arrays or large numbers, consider using appropriate data types to prevent overflow.</p>
                </div>
            </div>
            
            <div class="collapsible">
                <div class="collapsible-header" onclick="toggleCollapsible('edge-cases')">
                    ▶ Edge Cases & Boundary Conditions
                </div>
                <div class="collapsible-content" id="edge-cases">
                    <h4>Empty Array:</h4>
                    <p>Return empty array</p>
                    
                    <h4>Single Element:</h4>
                    <p>Result array contains the same single element</p>
                    
                    <h4>All Zeros:</h4>
                    <p>Result array will be all zeros</p>
                    
                    <h4>Negative Numbers:</h4>
                    <p>Algorithm works the same way, just keep adding negative numbers</p>
                    
                    <h4>Large Numbers:</h4>
                    <p>Watch for integer overflow in languages with fixed integer sizes</p>
                </div>
            </div>
        </div>
        
        <div class="right-panel">
            <div class="step-counter" id="step-counter">Step: 0 / 4</div>
            
            <div class="array-display">
                <div class="array-label">Input Array:</div>
                <div class="array-container" id="input-array"></div>
            </div>
            
            <div class="array-display">
                <div class="array-label">Result Array:</div>
                <div class="array-container" id="result-array"></div>
            </div>
        </div>
    </div>

    <script>
        const inputArray = [1, 2, 3, 4];
        const resultArray = [null, null, null, null];
        let currentStep = 0;
        let sum = 0;
        let i = 0;
        
        const steps = [
            {
                i: 0,
                sum: 1,
                condition: "i < array.length (0 < 4) ✓",
                operation: "sum += arr[0] (0 + 1 = 1), result[0] = 1",
                resultValue: 1,
                activeVar: ['i', 'sum']
            },
            {
                i: 1,
                sum: 3,
                condition: "i < array.length (1 < 4) ✓",
                operation: "sum += arr[1] (1 + 2 = 3), result[1] = 3",
                resultValue: 3,
                activeVar: ['i', 'sum']
            },
            {
                i: 2,
                sum: 6,
                condition: "i < array.length (2 < 4) ✓",
                operation: "sum += arr[2] (3 + 3 = 6), result[2] = 6",
                resultValue: 6,
                activeVar: ['i', 'sum']
            },
            {
                i: 3,
                sum: 10,
                condition: "i < array.length (3 < 4) ✓",
                operation: "sum += arr[3] (6 + 4 = 10), result[3] = 10",
                resultValue: 10,
                activeVar: ['i', 'sum']
            }
        ];
        
        function initializeDisplay() {
            const inputContainer = document.getElementById('input-array');
            const resultContainer = document.getElementById('result-array');
            
            inputContainer.innerHTML = '';
            resultContainer.innerHTML = '';
            
            inputArray.forEach((val, index) => {
                const cell = document.createElement('div');
                cell.className = 'array-cell';
                cell.textContent = val;
                cell.id = `input-${index}`;
                inputContainer.appendChild(cell);
            });
            
            resultArray.forEach((val, index) => {
                const cell = document.createElement('div');
                cell.className = 'array-cell';
                cell.textContent = val === null ? '_' : val;
                cell.id = `result-${index}`;
                resultContainer.appendChild(cell);
            });
        }
        
        function updateDisplay() {
            document.getElementById('val-i').textContent = currentStep < steps.length ? steps[currentStep].i : i;
            document.getElementById('val-sum').textContent = currentStep === 0 ? 0 : (currentStep <= steps.length ? steps[currentStep - 1].sum : sum);
            document.getElementById('step-counter').textContent = `Step: ${currentStep} / ${steps.length}`;
            
            document.querySelectorAll('.variable').forEach(v => {
                v.className = 'variable';
            });
            
            if (currentStep > 0 && currentStep <= steps.length) {
                const step = steps[currentStep - 1];
                step.activeVar.forEach(varName => {
                    document.getElementById(`var-${varName}`).className = 'variable active';
                });
                
                document.getElementById('current-condition').innerHTML = `<div class="condition true">${step.condition}</div>`;
                document.getElementById('current-operation').innerHTML = `<div class="operation add">${step.operation}</div>`;
                
                for (let j = 0; j < currentStep; j++) {
                    resultArray[j] = steps[j].resultValue;
                    document.getElementById(`result-${j}`).textContent = steps[j].resultValue;
                    document.getElementById(`result-${j}`).className = 'array-cell processed';
                }
                
                document.getElementById(`input-${step.i}`).className = 'array-cell current';
                
                const pointer = document.querySelector('.pointer');
                if (pointer) pointer.remove();
                
                const inputCell = document.getElementById(`input-${step.i}`);
                const newPointer = document.createElement('div');
                newPointer.className = 'pointer current';
                newPointer.textContent = 'i';
                inputCell.appendChild(newPointer);
                
            } else if (currentStep === 0) {
                document.getElementById('current-condition').textContent = 'Ready to start';
                document.getElementById('current-operation').textContent = 'Click Next to begin';
                
                document.querySelectorAll('.array-cell').forEach(cell => {
                    cell.className = 'array-cell';
                });
                
                document.querySelectorAll('.pointer').forEach(p => p.remove());
                
                for (let j = 0; j < resultArray.length; j++) {
                    resultArray[j] = null;
                    document.getElementById(`result-${j}`).textContent = '_';
                }
            } else {
                document.getElementById('current-condition').innerHTML = '<div class="condition false">i < array.length (4 < 4) ✗</div>';
                document.getElementById('current-operation').textContent = 'Algorithm completed';
                
                document.querySelectorAll('.array-cell').forEach(cell => {
                    cell.className = 'array-cell processed';
                });
                
                document.querySelectorAll('.pointer').forEach(p => p.remove());
            }
            
            let resultText = '[';
            for (let j = 0; j < resultArray.length; j++) {
                resultText += resultArray[j] === null ? '_' : resultArray[j];
                if (j < resultArray.length - 1) resultText += ', ';
            }
            resultText += ']';
            document.getElementById('result-display').textContent = resultText;
            
            document.getElementById('prevBtn').disabled = currentStep === 0;
            document.getElementById('nextBtn').disabled = currentStep >= steps.length;
        }
        
        function nextStep() {
            if (currentStep < steps.length) {
                currentStep++;
                updateDisplay();
            }
        }
        
        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                updateDisplay();
            }
        }
        
        function reset() {
            currentStep = 0;
            i = 0;
            sum = 0;
            updateDisplay();
        }
        
        function toggleCollapsible(id) {
            const content = document.getElementById(id);
            const header = content.previousElementSibling;
            
            if (content.classList.contains('show')) {
                content.classList.remove('show');
                header.textContent = header.textContent.replace('▼', '▶');
            } else {
                content.classList.add('show');
                header.textContent = header.textContent.replace('▶', '▼');
            }
        }
        
        document.getElementById('nextBtn').addEventListener('click', nextStep);
        document.getElementById('prevBtn').addEventListener('click', prevStep);
        document.getElementById('resetBtn').addEventListener('click', reset);
        
        initializeDisplay();
        updateDisplay();
    </script>
</body>
</html>
