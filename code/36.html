<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Substring Search Algorithm Visualization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background: white;
            color: black;
            padding: 10px;
            height: 100vh;
            overflow: hidden;
        }
        
        .container {
            display: flex;
            height: 100%;
            gap: 20px;
        }
        
        .left-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
        }
        
        .right-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 500px;
        }
        
        .section {
            border: 1px solid black;
            padding: 10px;
        }
        
        .problem-section {
            background: white;
        }
        
        .navigation {
            display: flex;
            gap: 10px;
            justify-content: center;
            padding: 15px;
            border: 2px solid black;
        }
        
        .nav-btn {
            padding: 8px 16px;
            background: white;
            border: 2px solid black;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        .nav-btn:hover {
            background: #f0f0f0;
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .variables-section {
            background: white;
        }
        
        .variable-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 3px 0;
            margin: 2px 0;
        }
        
        .variable-name {
            font-weight: bold;
            min-width: 80px;
        }
        
        .variable-value {
            padding: 2px 6px;
            border: 1px solid black;
            min-width: 40px;
            text-align: center;
        }
        
        .highlight-yellow { background: yellow !important; }
        .highlight-green { background: #90EE90 !important; }
        .highlight-red { background: #FFB6C1 !important; }
        
        .conditions-section {
            background: white;
        }
        
        .condition {
            padding: 3px 0;
            margin: 2px 0;
        }
        
        .condition-true { color: green; }
        .condition-false { color: red; }
        
        .operations-section {
            background: white;
        }
        
        .operation {
            padding: 3px 0;
            margin: 2px 0;
            font-weight: bold;
        }
        
        .op-increment { color: green; }
        .op-decrement { color: red; }
        .op-compare { color: blue; }
        .op-return { color: purple; }
        
        .result-section {
            background: white;
        }
        
        .visualization {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }
        
        .string-container {
            position: relative;
            margin: 20px 0;
        }
        
        .string-display {
            display: flex;
            gap: 2px;
            margin: 10px 0;
        }
        
        .char-cell {
            width: 40px;
            height: 40px;
            border: 2px solid black;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: bold;
            background: white;
            position: relative;
        }
        
        .char-cell.current {
            border-color: #FF1493;
            border-width: 3px;
        }
        
        .char-cell.matching {
            background: #90EE90;
        }
        
        .char-cell.not-matching {
            background: #FFB6C1;
        }
        
        .pointer {
            position: absolute;
            font-size: 12px;
            font-weight: bold;
            padding: 2px 4px;
            border-radius: 3px;
            color: white;
            z-index: 10;
        }
        
        .pointer-i {
            background: #FF1493;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .pointer-j {
            background: #00CED1;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .collapsible {
            margin-top: 20px;
        }
        
        .collapsible-header {
            background: black;
            color: white;
            padding: 10px;
            cursor: pointer;
            text-align: center;
            font-weight: bold;
        }
        
        .collapsible-content {
            display: none;
            padding: 15px;
            border: 1px solid black;
            border-top: none;
        }
        
        .collapsible-content.active {
            display: block;
        }
        
        .step-counter {
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            border: 2px solid black;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="left-panel">
            <div class="section problem-section">
                <h3>Substring Search Problem</h3>
                <p><strong>Find the first occurrence of needle in haystack</strong></p>
                <p>Input: haystack="hello", needle="ll"</p>
                <p>Output: 2</p>
            </div>
            
            <div class="navigation">
                <button class="nav-btn" id="prevBtn">Previous</button>
                <button class="nav-btn" id="nextBtn">Next</button>
                <button class="nav-btn" id="resetBtn">Reset</button>
            </div>
            
            <div class="section variables-section">
                <h4>Variables</h4>
                <div class="variable-row">
                    <span class="variable-name">i</span>
                    <span class="variable-value" id="var-i">0</span>
                </div>
                <div class="variable-row">
                    <span class="variable-name">j</span>
                    <span class="variable-value" id="var-j">0</span>
                </div>
                <div class="variable-row">
                    <span class="variable-name">hayLen</span>
                    <span class="variable-value" id="var-haylen">5</span>
                </div>
                <div class="variable-row">
                    <span class="variable-name">needleLen</span>
                    <span class="variable-value" id="var-needlelen">2</span>
                </div>
            </div>
            
            <div class="section conditions-section">
                <h4>Condition Checks</h4>
                <div id="conditions-display"></div>
            </div>
            
            <div class="section operations-section">
                <h4>Current Operation</h4>
                <div id="operations-display"></div>
            </div>
            
            <div class="section result-section">
                <h4>Result</h4>
                <div id="result-display">Not found yet</div>
            </div>
            
            <div class="step-counter">
                <span id="step-counter">Step: 1</span>
            </div>
        </div>
        
        <div class="right-panel">
            <div class="visualization">
                <div class="string-container">
                    <h4>Haystack: "hello"</h4>
                    <div class="string-display" id="haystack-display"></div>
                </div>
                
                <div class="string-container">
                    <h4>Needle: "ll"</h4>
                    <div class="string-display" id="needle-display"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="collapsible">
        <div class="collapsible-header" onclick="toggleCollapsible('theory')">
            Algorithm Theory & Explanation
        </div>
        <div class="collapsible-content" id="theory">
            <h4>Algorithm Overview</h4>
            <p>The substring search algorithm uses a brute force approach with two pointers. We iterate through each position in the haystack and try to match the entire needle starting from that position.</p>
            
            <h4>Time Complexity</h4>
            <p>O(n*m) where n is length of haystack and m is length of needle</p>
            
            <h4>Space Complexity</h4>
            <p>O(1) - only using constant extra space</p>
            
            <h4>Key Insights</h4>
            <p>- Use two pointers: i for haystack position, j for needle position</p>
            <p>- Reset needle pointer when mismatch occurs</p>
            <p>- Early termination when remaining haystack is shorter than needle</p>
        </div>
    </div>

    <script>
        const haystack = "hello";
        const needle = "ll";
        const hayLen = haystack.length;
        const needleLen = needle.length;
        
        let currentStep = 0;
        let steps = [];
        
        function generateSteps() {
            steps = [];
            let i = 0;
            
            while (i <= hayLen - needleLen) {
                let j = 0;
                
                steps.push({
                    i: i,
                    j: j,
                    operation: `Start matching at position ${i}`,
                    condition: `i <= hayLen - needleLen (${i} <= ${hayLen - needleLen})`,
                    conditionResult: true,
                    result: "Searching...",
                    type: "start"
                });
                
                while (j < needleLen && haystack[i + j] === needle[j]) {
                    steps.push({
                        i: i,
                        j: j,
                        operation: `Match found: haystack[${i + j}] = '${haystack[i + j]}' equals needle[${j}] = '${needle[j]}'`,
                        condition: `haystack[${i + j}] === needle[${j}] ('${haystack[i + j]}' === '${needle[j]}')`,
                        conditionResult: true,
                        result: "Matching...",
                        type: "match"
                    });
                    j++;
                }
                
                if (j === needleLen) {
                    steps.push({
                        i: i,
                        j: j,
                        operation: `Complete match found! Return index ${i}`,
                        condition: `j === needleLen (${j} === ${needleLen})`,
                        conditionResult: true,
                        result: `Found at index ${i}`,
                        type: "found"
                    });
                    break;
                } else {
                    steps.push({
                        i: i,
                        j: j,
                        operation: `Mismatch: haystack[${i + j}] = '${haystack[i + j]}' != needle[${j}] = '${needle[j]}'`,
                        condition: `haystack[${i + j}] === needle[${j}] ('${haystack[i + j]}' === '${needle[j]}')`,
                        conditionResult: false,
                        result: "Mismatch, try next position",
                        type: "mismatch"
                    });
                }
                
                i++;
            }
            
            if (steps[steps.length - 1].type !== "found") {
                steps.push({
                    i: i,
                    j: 0,
                    operation: "Needle not found in haystack, return -1",
                    condition: `i > hayLen - needleLen (${i} > ${hayLen - needleLen})`,
                    conditionResult: true,
                    result: "Not found (-1)",
                    type: "notfound"
                });
            }
        }
        
        function initializeDisplay() {
            const haystackDiv = document.getElementById('haystack-display');
            const needleDiv = document.getElementById('needle-display');
            
            haystackDiv.innerHTML = '';
            needleDiv.innerHTML = '';
            
            for (let i = 0; i < haystack.length; i++) {
                const cell = document.createElement('div');
                cell.className = 'char-cell';
                cell.textContent = haystack[i];
                cell.id = `hay-${i}`;
                haystackDiv.appendChild(cell);
            }
            
            for (let i = 0; i < needle.length; i++) {
                const cell = document.createElement('div');
                cell.className = 'char-cell';
                cell.textContent = needle[i];
                cell.id = `needle-${i}`;
                needleDiv.appendChild(cell);
            }
        }
        
        function updateDisplay() {
            const step = steps[currentStep];
            if (!step) return;
            
            document.getElementById('var-i').textContent = step.i;
            document.getElementById('var-j').textContent = step.j;
            document.getElementById('step-counter').textContent = `Step: ${currentStep + 1}`;
            
            document.getElementById('var-i').className = 'variable-value highlight-yellow';
            document.getElementById('var-j').className = 'variable-value highlight-yellow';
            
            const conditionsDiv = document.getElementById('conditions-display');
            conditionsDiv.innerHTML = `<div class="condition ${step.conditionResult ? 'condition-true' : 'condition-false'}">
                ${step.condition} ${step.conditionResult ? '✓' : '✗'}
            </div>`;
            
            const operationsDiv = document.getElementById('operations-display');
            let opClass = 'op-compare';
            if (step.type === 'found') opClass = 'op-return';
            if (step.type === 'match') opClass = 'op-increment';
            if (step.type === 'mismatch') opClass = 'op-decrement';
            
            operationsDiv.innerHTML = `<div class="operation ${opClass}">
                ${step.operation}
            </div>`;
            
            document.getElementById('result-display').textContent = step.result;
            
            for (let i = 0; i < haystack.length; i++) {
                const cell = document.getElementById(`hay-${i}`);
                cell.className = 'char-cell';
                if (i >= step.i && i < step.i + needleLen) {
                    if (step.type === 'match' && i < step.i + step.j) {
                        cell.classList.add('matching');
                    } else if (step.type === 'mismatch' && i === step.i + step.j) {
                        cell.classList.add('not-matching');
                    } else if (i === step.i + step.j) {
                        cell.classList.add('current');
                    }
                }
            }
            
            for (let i = 0; i < needle.length; i++) {
                const cell = document.getElementById(`needle-${i}`);
                cell.className = 'char-cell';
                if (i < step.j) {
                    cell.classList.add('matching');
                } else if (i === step.j) {
                    cell.classList.add('current');
                }
            }
            
            const haystackDiv = document.getElementById('haystack-display');
            const existingPointers = haystackDiv.querySelectorAll('.pointer');
            existingPointers.forEach(p => p.remove());
            
            if (step.i < haystack.length) {
                const iPointer = document.createElement('div');
                iPointer.className = 'pointer pointer-i';
                iPointer.textContent = 'i';
                document.getElementById(`hay-${step.i}`).appendChild(iPointer);
            }
            
            const needleDiv = document.getElementById('needle-display');
            const existingNeedlePointers = needleDiv.querySelectorAll('.pointer');
            existingNeedlePointers.forEach(p => p.remove());
            
            if (step.j < needle.length) {
                const jPointer = document.createElement('div');
                jPointer.className = 'pointer pointer-j';
                jPointer.textContent = 'j';
                document.getElementById(`needle-${step.j}`).appendChild(jPointer);
            }
        }
        
        function nextStep() {
            if (currentStep < steps.length - 1) {
                currentStep++;
                updateDisplay();
            }
            updateButtons();
        }
        
        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                updateDisplay();
            }
            updateButtons();
        }
        
        function resetVisualization() {
            currentStep = 0;
            updateDisplay();
            updateButtons();
        }
        
        function updateButtons() {
            document.getElementById('prevBtn').disabled = currentStep === 0;
            document.getElementById('nextBtn').disabled = currentStep === steps.length - 1;
        }
        
        function toggleCollapsible(id) {
            const content = document.getElementById(id);
            content.classList.toggle('active');
        }
        
        document.getElementById('nextBtn').addEventListener('click', nextStep);
        document.getElementById('prevBtn').addEventListener('click', prevStep);
        document.getElementById('resetBtn').addEventListener('click', resetVisualization);
        
        generateSteps();
        initializeDisplay();
        updateDisplay();
        updateButtons();
    </script>
</body>
</html>
